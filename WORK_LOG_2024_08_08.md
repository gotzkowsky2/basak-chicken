### 8월 8일 작업 기록 요약 (월 8/11 점검용)

- 주요 이슈 진단/해결
  - 정적 자산이 HTML로 응답되어 아이콘만 크게 보이는 현상: 루트 `middleware.ts` 제거, `src/middleware.ts`에서 정적 경로(`/_next/*`, `/*.css`, 이미지/폰트 등) 및 API 우회 보장
  - 빌드 실패(중복 POST): `src/app/api/admin/checklists/route.ts`에서 복사 POST가 중복 정의되어 제거(현재는 생성 POST, 목록 GET만)
  - 템플릿 복사 500 오류: Prisma 스키마상 `ChecklistItem.type` 필수 → 복사 API에서 필수 필드(`type`, `instructions`, `isRequired`, `isActive`, `order`) 복제 및 누락 시 기본값 보정
  - 연결항목 미복사: 복사 API를 재귀 복제로 개선하여 항목/자식 각 단계에서 `connectedItems` 동시 복사
  - 접속/정적 파일 404: `next.config.js`의 `output: 'standalone'` 제거 및 PM2를 `next start -p 3001`로 복구하여 정적 CSS/JS 정상 서빙 확인
  - 입력 필드 가독성: 관리자 템플릿 복사 모달 입력 글자색/테두리 대비 강화

- 반영된 코드(핵심)
  - `src/middleware.ts`: 정적/이미지/API/확장자 파일 우회 + 인증 리다이렉트 최소화
  - `src/app/api/admin/checklists/route.ts`: 생성 POST, 목록 GET만 유지(중복 POST 제거)
  - `src/app/api/admin/checklists/copy/route.ts`: 재귀 복사 + 연결항목 복사 + `type` 기본값 보정
  - `src/app/admin/checklists/page.tsx`: 복사 모달 입력 UI 가독성 개선
  - `ecosystem.config.js`: PM2 실행 방식을 `next start -p 3001`로 복귀
  - `next.config.js`: `output: 'standalone'` 제거, CSS 최적화 비활성 유지

- 현재 상태
  - 프로덕션 모드(PM2, NODE_ENV=production, 포트 3001)로 기동
  - 정적 자산 200 OK, 페이지 접근 정상
  - 관리자 템플릿 복사 기능: 새 이름 입력 → 항목/자식/연결항목 포함 복제(예외 데이터 방어 포함)

- 8/11(월) 점검 체크리스트
  - 템플릿 복사 후 항목 계층/연결항목/`type` 정상 여부 확인
  - 복사 모달 입력 가독성(모바일 320px 포함)
  - 관리자/직원 주요 페이지 접속 및 정적 자산 로딩 재확인
  - 주의사항/매뉴얼/재고의 모바일(320px) UI 재점검
  - 제출내역(관리자/직원)에서 이전 수치 표시 정상 여부(신규 저장분 기준)
  - 직원 체크리스트 상단 숨김 스위치(기본 ON) 동작/애니메이션 확인

- 남은 할 일(우선순위)
  - 체크 상태 유지(페이지 이동 시), 완료자 표시 개선(`CURRENT_STATUS.md` 항목)
  - 리스트 가상화 본격 적용(`react-window`) 및 캐시 TTL/무효화 정리
  - 콘솔 로그 정리
  - 복사 기능: 빈 `type` 등 예외 데이터 추가 방어/유효성 메시지 강화

- 운영/배포 메모
  - 운영 포트: 3001, 도메인 접근: http://crew.basak-chicken.com:3001 (HTTPS는 외부 프록시)
  - PM2 앱: `basak-chicken-app` (cluster 1)
  - 클린 빌드: `.next/.turbo` 삭제 → `npm run build` → `pm2 restart basak-chicken-app`
